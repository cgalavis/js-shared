<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>StringList.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Array.html">Array</a><ul class='methods'><li data-type='method'><a href="Array.html#empty">empty</a></li><li data-type='method'><a href="Array.html#first">first</a></li><li data-type='method'><a href="Array.html#isLast">isLast</a></li><li data-type='method'><a href="Array.html#last">last</a></li></ul></li><li><a href="Date.html">Date</a><ul class='methods'><li data-type='method'><a href="Date.html#.format">format</a></li><li data-type='method'><a href="Date.html#.formatLength">formatLength</a></li><li data-type='method'><a href="Date.html#.sameDay">sameDay</a></li><li data-type='method'><a href="Date.html#addDays">addDays</a></li><li data-type='method'><a href="Date.html#addHours">addHours</a></li><li data-type='method'><a href="Date.html#addMillis">addMillis</a></li><li data-type='method'><a href="Date.html#addMinutes">addMinutes</a></li><li data-type='method'><a href="Date.html#addMonths">addMonths</a></li><li data-type='method'><a href="Date.html#addSeconds">addSeconds</a></li><li data-type='method'><a href="Date.html#addYears">addYears</a></li><li data-type='method'><a href="Date.html#diff">diff</a></li><li data-type='method'><a href="Date.html#earlierDayThan">earlierDayThan</a></li><li data-type='method'><a href="Date.html#format">format</a></li><li data-type='method'><a href="Date.html#incDay">incDay</a></li><li data-type='method'><a href="Date.html#incHour">incHour</a></li><li data-type='method'><a href="Date.html#incMilli">incMilli</a></li><li data-type='method'><a href="Date.html#incMinute">incMinute</a></li><li data-type='method'><a href="Date.html#incMonth">incMonth</a></li><li data-type='method'><a href="Date.html#incSecond">incSecond</a></li><li data-type='method'><a href="Date.html#incYear">incYear</a></li><li data-type='method'><a href="Date.html#laterDayThan">laterDayThan</a></li><li data-type='method'><a href="Date.html#sameDay">sameDay</a></li><li data-type='method'><a href="Date.html#toUtc">toUtc</a></li><li data-type='method'><a href="Date.html#truncTime">truncTime</a></li></ul></li><li><a href="module-@crabel_shared_csv-CsvReader.html">CsvReader</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_csv-CsvReader.html#toString">toString</a></li></ul></li><li><a href="module-@crabel_shared_range-ArrayRange.html">ArrayRange</a></li><li><a href="module-@crabel_shared_range-Range.html">Range</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_range-Range.html#add">add</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#clear">clear</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#combine">combine</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#empty">empty</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#exclude">exclude</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#forEach">forEach</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#from">from</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#inRange">inRange</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#intervalFromArray">intervalFromArray</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#same">same</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#subtract">subtract</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#to">to</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#toString">toString</a></li><li data-type='method'><a href="module-@crabel_shared_range-Range.html#validInterval">validInterval</a></li></ul></li><li><a href="Number.html">Number</a><ul class='methods'><li data-type='method'><a href="Number.html#between">between</a></li><li data-type='method'><a href="Number.html#nextPow2">nextPow2</a></li><li data-type='method'><a href="Number.html#prevPow2">prevPow2</a></li><li data-type='method'><a href="Number.html#roundToInt">roundToInt</a></li><li data-type='method'><a href="Number.html#toEnum">toEnum</a></li><li data-type='method'><a href="Number.html#toTime">toTime</a></li><li data-type='method'><a href="Number.html#truncToInt">truncToInt</a></li><li data-type='method'><a href="Number.html#zeroPadd">zeroPadd</a></li></ul></li><li><a href="Object.html">Object</a><ul class='methods'><li data-type='method'><a href="Object.html#.className">className</a></li><li data-type='method'><a href="Object.html#.contains">contains</a></li><li data-type='method'><a href="Object.html#.copy">copy</a></li><li data-type='method'><a href="Object.html#.isPrimitive">isPrimitive</a></li><li data-type='method'><a href="Object.html#.isType">isType</a></li><li data-type='method'><a href="Object.html#className">className</a></li><li data-type='method'><a href="Object.html#clone">clone</a></li><li data-type='method'><a href="Object.html#contains">contains</a></li><li data-type='method'><a href="Object.html#is">is</a></li><li data-type='method'><a href="Object.html#isPrimitive">isPrimitive</a></li><li data-type='method'><a href="Object.html#merge">merge</a></li></ul></li><li><a href="StringList.html">StringList</a><ul class='methods'><li data-type='method'><a href="StringList.html#clear">clear</a></li><li data-type='method'><a href="StringList.html#count">count</a></li><li data-type='method'><a href="StringList.html#empty">empty</a></li><li data-type='method'><a href="StringList.html#forEach">forEach</a></li><li data-type='method'><a href="StringList.html#line">line</a></li><li data-type='method'><a href="StringList.html#load">load</a></li><li data-type='method'><a href="StringList.html#merge">merge</a></li><li data-type='method'><a href="StringList.html#newLine">newLine</a></li><li data-type='method'><a href="StringList.html#remove">remove</a></li><li data-type='method'><a href="StringList.html#save">save</a></li><li data-type='method'><a href="StringList.html#toString">toString</a></li><li data-type='method'><a href="StringList.html#write">write</a></li><li data-type='method'><a href="StringList.html#writeLine">writeLine</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="index.module_js.html">js</a></li><li><a href="module-@crabel_shared_csv.html">@crabel/shared/csv</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_csv.html#~csvToArray">csvToArray</a></li></ul></li><li><a href="module-@crabel_shared_fs_util.html">@crabel/shared/fs_util</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.addExt">addExt</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.copy">copy</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.ensurePath">ensurePath</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.erase">erase</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.loadText">loadText</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.makeUnique">makeUnique</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.move">move</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.removeExt">removeExt</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.saveText">saveText</a></li><li data-type='method'><a href="module-@crabel_shared_fs_util.html#.swapExt">swapExt</a></li></ul></li><li><a href="module-@crabel_shared_proto.html">@crabel/shared/proto</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_proto.html#.init">init</a></li></ul></li><li><a href="module-@crabel_shared_range.html">@crabel/shared/range</a></li><li><a href="module-@crabel_shared_str_util.html">@crabel/shared/str_util</a><ul class='methods'><li data-type='method'><a href="module-@crabel_shared_str_util.html#.align">align</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.alignC">alignC</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.alignL">alignL</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.alignR">alignR</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.buildTable">buildTable</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.capitalize">capitalize</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.combineLines">combineLines</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.crc32">crc32</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.decapitalize">decapitalize</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.expand">expand</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.fill">fill</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.format">format</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.formatError">formatError</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.indent">indent</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.splitLines">splitLines</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.substDate">substDate</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.substEnv">substEnv</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.substProp">substProp</a></li><li data-type='method'><a href="module-@crabel_shared_str_util.html#.toObject">toObject</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">StringList.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

let fs = require("fs");
let os = require("os");

require("./proto").init();
let fs_util = require("./fs_util");
let str_util = require("./str_util");

/**
 * The StringList object provides access to a list of strings similar to a document
 * making it convenient for outputting  to log files or reports. The information stored
 * can be referenced as a string, a list, of saved/loaded from files.
 * @param {String} [delimiter=os.EOL]
 * @constructor
 */
function StringList(delimiter) {
    if (undefined === delimiter)
        delimiter = os.EOL;

    this.delimiter = delimiter;
    this.lines = [];
}

/**
 * Return true if the StringList is empty.
 * @returns {Boolean}
 */
StringList.prototype.empty = function () {
    return this.lines.empty();
};

/**
 * Returns the number of lines in the StringList.
 * @returns {Number}
 */
StringList.prototype.count = function () {
    return this.lines.length;
};

/**
 * Returns the line in the given index.
 * @param {Number} index
 * @returns {String}
 */
StringList.prototype.line = function (index) {
    if (0 &lt; index || index >= this.lines.length)
        throw new Error("Index out of bounds");

    return this.lines[index];
};

/**
 * Converts the StringList into a string inserting an end-of-line sequence at the end of
 * every line. By default the os.EOL is used, this can be overwritten by passing a
 * different sequence by parameter.
 * @returns {String}
 */
StringList.prototype.toString = function () {
    if (this.lines.empty())
        return "";

    let res = this.lines.first();

    if (this.lines.length > 1) {
        for (let i = 1; i &lt; this.lines.length; ++i)
            res += this.delimiter + this.lines[i];
    }
    return res;
};


/**
 * Inserts one or more new empty lines to the StringList.
 * @param {Number} [count]
 */
StringList.prototype.newLine = function (count) {
    if (undefined === count)
        count = 1;

    for (let i = 0; i &lt; count; ++i)
        this.lines.push("");
};


/**
 * Writes the given "str" to the StringList, the string is appended to the current line.
 * Additional parameters can be passed, these parameters are used for substitution through
 * the 'format' function of the input string. The StringList is returned to allow method
 * chaining.
 * Usage:
 *      let st = new StringList();
 *      st.writeLine("Current date is: {0}", new Date());
 * @param {String} str
 * @returns {StringList}
 */
StringList.prototype.write = function (str) {
    if (undefined === str)
        throw new Error("Call to 'write' with missing argument.");

    let val;
    if (1 == arguments.length)
        val = str;
    else {
        let args = Array.prototype.slice.call(arguments);
        val = str_util.format.apply(str, args.slice(1, args.length));
    }

    if (this.lines.empty())
        this.lines.push(val);
    else {
        let i = this.lines.length - 1;
        this.lines[i] += val;
    }
    return this;
};


/**
 * Adds the given line to the StringList followed by an end-of-line. The StringList is
 * returned to allow method chaining.
 * @param {String} line
 * @returns {StringList}
 */
StringList.prototype.writeLine = function (line) {
    if (undefined === line)
        throw new Error("Call to 'writeLine' with missing argument, use 'newLine' to add an empty line.");

    this.write.apply(this, arguments);
    this.newLine();
    return this;
};


/**
 * Iterates through the StringList lines calling the callback on each iteration, the
 * callback receives the current line and its index.
 *      Callback Signature: function (line, index)
 * @param {Function} callback
 */
StringList.prototype.forEach = function (callback) {
    if (undefined === callback || "function" != typeof (callback))
        throw new Error("Invalid call to 'forEach', the callback function was not " +
            "passed or was not a function.");

    for (let i = 0; i &lt; this.lines.length; ++i)
        callback.call(this, this.lines[i], i, this);
};


/**
 * Adds the content of other StringLists to this one. Multiple lists can be added in the
 * same call. Returns the StringList to allow method chaining.
 * @returns {StringList}
 */
StringList.prototype.merge = function () {
    for (let i = 0; i &lt; arguments.length; ++i)
        if (undefined !== arguments[i].lines)
            this.lines.push.apply(this.lines, arguments[i].lines);

    return this;
};


/**
 * Deletes a single line from the StringList
 * @param {Number} index
 * @param {Number} count
 * @returns {String[]}
 */ StringList.prototype.remove = function (index, count)
{
    if (undefined === count)
        return this.lines.splice(index, 1);

    return this.lines.splice(index, count);
};


/**
 * Removes all content from the Stringlist. Returns the StringList to allow method
 * chaining.
 * @returns {StringList}
 */
StringList.prototype.clear = function () {
    this.lines.length = 0;
    return this;
};


/**
 * Stores the content of the Stringlist into the given file. The path to the file is
 * created if needed. Returns the StringList to allow method chaining.
 * @param {String} fname
 * @param {Boolean} safe
 * @returns {StringList}
 */
StringList.prototype.save = function (fname, safe) {
    fs_util.ensurePath(path.getParent(fname));
    fs_util.saveText(fname, this.toString(), safe);
    return this;
};


/**
 * Load the given file and add it's content to the StringList. This method completely
 * replaces the content of the StringList. Returns the StringList object to allow method
 * chaining.
 * @param {String} fname
 * @returns {StringList}
 */
StringList.prototype.load = function (fname) {
    if (!fs.exists(fname))

        throw new Error(str_util.format("Failed to load content for StringList, the " +
            "file '{0} does not exist.'", fname));

    // Process Windows formatted lines
    let content = fs_util.loadText(fname).split("\r\n");
    
    this.clear();
    for (let i = 0; i &lt; content.length; ++i) {
        // Process Unix formatted lines
        let sub_content = content[i].split("\n");
        for (let j = 0; j &lt; sub_content.length; ++j)
            this.lines.push(sub_content[j]);
    }
    return  this;
};

module.exports = StringList;</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Apr 02 2018 17:55:42 GMT-0400 (EDT) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
