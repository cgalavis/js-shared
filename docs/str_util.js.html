

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: str_util.js | Source: str_util.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 0px; height: 0px">
        <img src="img/toast-ui.png" width="100%" height="100%">
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: str_util.js</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-@crabel_shared_csv.html">@crabel/shared/csv</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/csv_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_csv.html#~csvToArray">csvToArray</a></li></ul></div></li><li><a href="module-@crabel_shared_fs_util.html">@crabel/shared/fs_util</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/fs_util_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_fs_util.html#.addExt">addExt</a></li><li><a href="module-@crabel_shared_fs_util.html#.copy">copy</a></li><li><a href="module-@crabel_shared_fs_util.html#.ensurePath">ensurePath</a></li><li><a href="module-@crabel_shared_fs_util.html#.erase">erase</a></li><li><a href="module-@crabel_shared_fs_util.html#.loadText">loadText</a></li><li><a href="module-@crabel_shared_fs_util.html#.makeUnique">makeUnique</a></li><li><a href="module-@crabel_shared_fs_util.html#.move">move</a></li><li><a href="module-@crabel_shared_fs_util.html#.removeExt">removeExt</a></li><li><a href="module-@crabel_shared_fs_util.html#.saveText">saveText</a></li><li><a href="module-@crabel_shared_fs_util.html#.swapExt">swapExt</a></li></ul></div></li><li><a href="module-@crabel_shared_Log.html">@crabel/shared/Log</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/Log_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_Log.html#~_applySubst">_applySubst</a></li><li><a href="module-@crabel_shared_Log.html#~_log">_log</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-@crabel_shared_Log.html#~Column">Column</a></li><li><a href="module-@crabel_shared_Log.html#~Event">Event</a></li><li><a href="module-@crabel_shared_Log.html#~LogCallback">LogCallback</a></li><li><a href="module-@crabel_shared_Log.html#~LogOptions">LogOptions</a></li><li><a href="module-@crabel_shared_Log.html#~Table">Table</a></li></ul></div></li><li><a href="module-@crabel_shared_proto.html">@crabel/shared/proto</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/proto_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_proto.html#.init">init</a></li></ul></div></li><li><a href="module-@crabel_shared_range.html">@crabel/shared/range</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/range_sub"></div></li><li><a href="module-@crabel_shared_str_util.html">@crabel/shared/str_util</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/str_util_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_str_util.html#.align">align</a></li><li><a href="module-@crabel_shared_str_util.html#.alignC">alignC</a></li><li><a href="module-@crabel_shared_str_util.html#.alignL">alignL</a></li><li><a href="module-@crabel_shared_str_util.html#.alignR">alignR</a></li><li><a href="module-@crabel_shared_str_util.html#.buildTable">buildTable</a></li><li><a href="module-@crabel_shared_str_util.html#.capitalize">capitalize</a></li><li><a href="module-@crabel_shared_str_util.html#.crc32">crc32</a></li><li><a href="module-@crabel_shared_str_util.html#.expand">expand</a></li><li><a href="module-@crabel_shared_str_util.html#.fill">fill</a></li><li><a href="module-@crabel_shared_str_util.html#.format">format</a></li><li><a href="module-@crabel_shared_str_util.html#.formatError">formatError</a></li><li><a href="module-@crabel_shared_str_util.html#.substDate">substDate</a></li><li><a href="module-@crabel_shared_str_util.html#.substEnv">substEnv</a></li><li><a href="module-@crabel_shared_str_util.html#.substProp">substProp</a></li><li><a href="module-@crabel_shared_str_util.html#.toObject">toObject</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-@crabel_shared_str_util.html#~FormatterCallback">FormatterCallback</a></li><li><a href="module-@crabel_shared_str_util.html#~ReviverCallback">ReviverCallback</a></li><li><a href="module-@crabel_shared_str_util.html#~SubstCallback">SubstCallback</a></li><li><a href="module-@crabel_shared_str_util.html#~TableColumn">TableColumn</a></li><li><a href="module-@crabel_shared_str_util.html#~TableSpecs">TableSpecs</a></li><li><a href="module-@crabel_shared_str_util.html#~Token">Token</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Array.html">Array</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Array_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Array.html#empty">empty</a></li><li><a href="Array.html#first">first</a></li><li><a href="Array.html#isLast">isLast</a></li><li><a href="Array.html#last">last</a></li></ul></div></li><li><a href="Date.html">Date</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Date_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Date.html#.format">format</a></li><li><a href="Date.html#.formatLength">formatLength</a></li><li><a href="Date.html#.sameDay">sameDay</a></li><li><a href="Date.html#addDays">addDays</a></li><li><a href="Date.html#addHours">addHours</a></li><li><a href="Date.html#addMillis">addMillis</a></li><li><a href="Date.html#addMinutes">addMinutes</a></li><li><a href="Date.html#addMonths">addMonths</a></li><li><a href="Date.html#addSeconds">addSeconds</a></li><li><a href="Date.html#addYears">addYears</a></li><li><a href="Date.html#diff">diff</a></li><li><a href="Date.html#earlierDayThan">earlierDayThan</a></li><li><a href="Date.html#format">format</a></li><li><a href="Date.html#incDay">incDay</a></li><li><a href="Date.html#incHour">incHour</a></li><li><a href="Date.html#incMilli">incMilli</a></li><li><a href="Date.html#incMinute">incMinute</a></li><li><a href="Date.html#incMonth">incMonth</a></li><li><a href="Date.html#incSecond">incSecond</a></li><li><a href="Date.html#incYear">incYear</a></li><li><a href="Date.html#laterDayThan">laterDayThan</a></li><li><a href="Date.html#sameDay">sameDay</a></li><li><a href="Date.html#toUtc">toUtc</a></li><li><a href="Date.html#truncTime">truncTime</a></li></ul></div></li><li><a href="module-@crabel_shared_csv-CsvReader.html">CsvReader</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/csv~CsvReader_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-@crabel_shared_csv-CsvReader.html#doc">doc</a></li><li><a href="module-@crabel_shared_csv-CsvReader.html#headers">headers</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_csv-CsvReader.html#toString">toString</a></li></ul></div></li><li><a href="module-@crabel_shared_Log-Log.html">Log</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/Log~Log_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-@crabel_shared_Log-Log.html#.eventType">eventType</a></li><li><a href="module-@crabel_shared_Log-Log.html#.mode">mode</a></li><li><a href="module-@crabel_shared_Log-Log.html#caption">caption</a></li><li><a href="module-@crabel_shared_Log-Log.html#echo">echo</a></li><li><a href="module-@crabel_shared_Log-Log.html#file">file</a></li><li><a href="module-@crabel_shared_Log-Log.html#file_name">file_name</a></li><li><a href="module-@crabel_shared_Log-Log.html#level">level</a></li><li><a href="module-@crabel_shared_Log-Log.html#lineWidth">lineWidth</a></li><li><a href="module-@crabel_shared_Log-Log.html#mode">mode</a></li><li><a href="module-@crabel_shared_Log-Log.html#name">name</a></li><li><a href="module-@crabel_shared_Log-Log.html#path">path</a></li><li><a href="module-@crabel_shared_Log-Log.html#pendingEvents">pendingEvents</a></li><li><a href="module-@crabel_shared_Log-Log.html#separator">separator</a></li><li><a href="module-@crabel_shared_Log-Log.html#timeFormat">timeFormat</a></li><li><a href="module-@crabel_shared_Log-Log.html#typeLabels">typeLabels</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_Log-Log.html#.err">err</a></li><li><a href="module-@crabel_shared_Log-Log.html#.global">global</a></li><li><a href="module-@crabel_shared_Log-Log.html#.info">info</a></li><li><a href="module-@crabel_shared_Log-Log.html#.out">out</a></li><li><a href="module-@crabel_shared_Log-Log.html#.shutdown">shutdown</a></li><li><a href="module-@crabel_shared_Log-Log.html#.trace">trace</a></li><li><a href="module-@crabel_shared_Log-Log.html#.warn">warn</a></li><li><a href="module-@crabel_shared_Log-Log.html#active">active</a></li><li><a href="module-@crabel_shared_Log-Log.html#err">err</a></li><li><a href="module-@crabel_shared_Log-Log.html#info">info</a></li><li><a href="module-@crabel_shared_Log-Log.html#out">out</a></li><li><a href="module-@crabel_shared_Log-Log.html#shutdown">shutdown</a></li><li><a href="module-@crabel_shared_Log-Log.html#trace">trace</a></li><li><a href="module-@crabel_shared_Log-Log.html#warn">warn</a></li></ul></div></li><li><a href="module-@crabel_shared_range-ArrayRange.html">ArrayRange</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/range~ArrayRange_sub"></div></li><li><a href="module-@crabel_shared_range-Range.html">Range</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:@crabel/shared/range~Range_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-@crabel_shared_range-Range.html#add">add</a></li><li><a href="module-@crabel_shared_range-Range.html#clear">clear</a></li><li><a href="module-@crabel_shared_range-Range.html#combine">combine</a></li><li><a href="module-@crabel_shared_range-Range.html#empty">empty</a></li><li><a href="module-@crabel_shared_range-Range.html#exclude">exclude</a></li><li><a href="module-@crabel_shared_range-Range.html#forEach">forEach</a></li><li><a href="module-@crabel_shared_range-Range.html#from">from</a></li><li><a href="module-@crabel_shared_range-Range.html#inRange">inRange</a></li><li><a href="module-@crabel_shared_range-Range.html#intervalFromArray">intervalFromArray</a></li><li><a href="module-@crabel_shared_range-Range.html#same">same</a></li><li><a href="module-@crabel_shared_range-Range.html#subtract">subtract</a></li><li><a href="module-@crabel_shared_range-Range.html#to">to</a></li><li><a href="module-@crabel_shared_range-Range.html#toString">toString</a></li><li><a href="module-@crabel_shared_range-Range.html#validInterval">validInterval</a></li></ul></div></li><li><a href="Number.html">Number</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Number_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Number.html#between">between</a></li><li><a href="Number.html#nextPow2">nextPow2</a></li><li><a href="Number.html#prevPow2">prevPow2</a></li><li><a href="Number.html#roundToInt">roundToInt</a></li><li><a href="Number.html#toEnum">toEnum</a></li><li><a href="Number.html#toTime">toTime</a></li><li><a href="Number.html#truncToInt">truncToInt</a></li><li><a href="Number.html#zeroPadd">zeroPadd</a></li></ul></div></li><li><a href="Object.html">Object</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Object_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Object.html#.className">className</a></li><li><a href="Object.html#.contains">contains</a></li><li><a href="Object.html#.copy">copy</a></li><li><a href="Object.html#.isPrimitive">isPrimitive</a></li><li><a href="Object.html#.isType">isType</a></li><li><a href="Object.html#className">className</a></li><li><a href="Object.html#clone">clone</a></li><li><a href="Object.html#contains">contains</a></li><li><a href="Object.html#is">is</a></li><li><a href="Object.html#isPrimitive">isPrimitive</a></li><li><a href="Object.html#merge">merge</a></li></ul></div></li><li><a href="StringList.html">StringList</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="StringList_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="StringList.html#clear">clear</a></li><li><a href="StringList.html#count">count</a></li><li><a href="StringList.html#empty">empty</a></li><li><a href="StringList.html#forEach">forEach</a></li><li><a href="StringList.html#line">line</a></li><li><a href="StringList.html#load">load</a></li><li><a href="StringList.html#merge">merge</a></li><li><a href="StringList.html#newLine">newLine</a></li><li><a href="StringList.html#remove">remove</a></li><li><a href="StringList.html#save">save</a></li><li><a href="StringList.html#toString">toString</a></li><li><a href="StringList.html#write">write</a></li><li><a href="StringList.html#writeLine">writeLine</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/**
 * This module is part of the Crabel core library, it contains utility functions that
 * extend the standard &lt;b>String&lt;/b> interface adding support for string transformation
 * and formatting including token replacement, text layout construction and more.
 * Formatting function (format and expand) provide token substitution services using the
 * familiar handlebars notation i.e. {{ token }}.
 * @module @crabel/shared/str_util
 * @author: Carlos Galavis &lt;cgalavis@crabel.com>
 */

require("./proto").init();
const os = require("os");
let columnify = require("columnify");


/**
 * @typedef {Object} Token
 * @property {String} name
 * @property {String[]} args
 */


/**
 * Callback function given to the 'expand' function to evaluate and determine value to be
 * used for substitution.
 * @callback SubstCallback
 * @param {Token} token Object representing the token. The object has a 'name' and 'args'
 * properties.
 * @param {...any} [arg] Additional arguments passed to the expand function.
 * @return {String|null} Value returned by the substitution callback function or null if
 * no substitution was
 * possible.
 */


/**
 * Callback function given to the 'str_util.substProp' function to format a given
 * property value.
 * @callback FormatterCallback
 * @param {Object} obj Object container object from which a value is used for
 * substitution.
 * @param {String} prop_name Name of the property of 'obj' whose value is being fetch for
 * substitution.
 * @return {String} Formatted value of obj[prop_name].
 */


/**
 * Callback function given to the 'toObject' function to customize the conversion of JSON
 * values to object property values.
 * @callback ReviverCallback
 * @param {String} key Key being assigned to the resulting object instance.
 * @param {String} value Value being assigned to the 'key' property.
 * @return {*} Value processed by the ReviverCallback function. This value is assigned
 * to the 'key' property in place
 * of the 'value' string that was in the JSON document.
 */


/**
 * @typedef {Object} TableColumn
 * @property {Number|String} width
 * @property {String} align
 */


/**
 * @typedef {Object} TableSpecs
 * @property {Array.&lt;TableColumn>} columns
 * @property {Array.&lt;Array.&lt;String>>} rows
 */


//

module.exports = {
    /**
     * Returns a string of given width filled with the given character.
     * @param {Number} width number of characters to add to the strin returned.
     * @param {String} [fill_char] the character to use when generaring the string.
     * @return {string} String containing the repeated sequence
     */
    fill: function (width, fill_char) {
        if (!width)
            throw new Error("Invalid call to 'str_util.fill', the 'width' parameter " +
                "is not optional.");

        fill_char = _normStr(fill_char, "str_util.fill", " ", 1);
        return (new Array(width + 1)).join(fill_char);
    },


    /**
     * Capitalizes the first letter of every word in the given &lt;tt>str&lt;/tt>.
     * @param {String} str
     * String to be capitalized.
     * @returns {String}
     * Returns a string with the first letter of every word capitalized.
     */
    capitalize: function (str) {
        if (!str || !str.toString)
            throw new Error("Invalid call to 'str_util.capitalize', an invalid " +
                "parameter was passed.");

        return str.replace(/(?:^|\s)\S/g, function (a) {
            return a.toUpperCase();
        });
    },


    /**
     * Replaces tokens of the form {N} where N indicates the index of the value to use
     * for replacement. Replacement values are passed as parameters to the function.
     * @param {String} str
     * String to be formatted. All the known tokens present in 'str' are replaced with
     * the values given by the rest of the function arguments.
     * @param {*} [subs...]
     * Values to be used during substitution.
     * @return {String}
     * Returns the formatted string.
     * @example
     *  &lt;caption>Converts text="Name: {{0}}, Last: {{1}}, Age: {{2}}" into
     *  formatted_text="Name: John, Last: Doe, Age: 43"&lt;/caption>
     *      let date_util = require("twt/date_util");
     *      let person = { Name: "John", Last: "Doe", Age: 43 };
     *      let text = "Name: {{0}}, Last: {{1}}, Age: {{2}}";
     *      let formatted_text = str_util.format(text, person.Name, person.Last person.Age);
     */
    format: function (str, subs /*, [subs2, ...]*/) {
        if (0 === arguments.length)
            throw new Error("Invalid call to 'str_util.format', no string was supplied");

        if (!str.toString)
            throw new Error("Invalid call to 'str_util.format', the 'str' parameter " +
                "must be a 'String' or support the 'toString' method.");


        str = str.toString();       // Make sure we have a string to work with
        if (1 === arguments.length)
            return str;

        let args = Array.prototype.slice.call(arguments).slice(1, arguments.length);
        if ("function" === typeof arguments[1])
            throw new Error("Invalid call to 'str_util.format', the first substitution " +
                "value is a function. Use 'expand' to use a substitution function.");

        return str.replace(/{{([^}}]+)}}/g, function (match, token) {
            let number = Number(token.trim());
            if (isNaN(number))
                return match;

            if (number &lt; args.length)
                return args[number];

            return match;
        });
    },


    /**
     * Returns an &lt;b>Error&lt;/b> object with the text &lt;b>str&lt;/b> expanded via the
     * &lt;b>format&lt;/b> function.
     * @param {String} str
     * String to be formatted. All the known tokens present in 'str' are replaced with
     * the values given by the rest of the function arguments.
     * @param {*} [subs...]
     * Values to be used during substitution.
     * @return {Error}
     */
    formatError: function (str, subs /*, [subs2, ...]*/) {
        return new Error(this.format.call(this, arguments));
    },


    /**
     * Expands substitutable tokens (text surrounded by handlebars) by invoking the
     * callback function. Parameters can be given along within the substitution token to
     * customize the behaviour of the substitution function, these parameters are
     * separated by a comma and can be enclosed within double quotes, for instance the
     * token {{ date, "yyyy/MM/dd" }} could be used to tell the substitution function to
     * format that date using the given date formatting string. If the callback function
     * returns 'null', the token is left alone.&lt;br>&lt;br>
     *
     * Additional parameters can be passed after 'subst_fn', these parameters are passed
     * through to the callback function every time it is invoked.
     *
     * @param {String} str
     * String to be expanded. Tokens found in this string are given to the callback
     * function for substitution.
     * @param {SubstCallback} [subst_fn]
     * Substitution callback function.
     * @param {*} [arg...]
     * Arguments to be passed on to the callback function.
     * @return {String}
     * Returns the expanded string.
     * @example
     *  &lt;caption>Converts text="date: yyyy/MM/dd" into expanded_text =
     *  "date: 2016/02/07"&lt;/caption>
     *   require(twt/proto);
     *   let date_util = require("twt/date_util");
     *   let text = "Current date: {{date, yyyy/MM/dd}}";
     *   let expanded_text = str_util.expand(text, function (token, date) {
     *      if ("date" === token.Name) {
     *          if (undefined !== token.Args[0] &amp;&amp; Object.isType(String))
     *              return date_util.format(date, token.Args[0]);
     *          return date.toString(); // no formatting string was given, use default
     *      }
     *
     *      return null; // token not supported
     *  }, new Date());
     */
    expand: function (str, subst_fn, arg /*[arg2, ...]*/) {
        let args = Array.prototype.slice.call(arguments).slice(2, arguments.length);
        return str.replace(/{{([^}}]+)}}/g, function (match, token) {
            token = token.trim();
            if (0 === token.length)
                return match;

            if (!subst_fn)
                return match;

            let tkparts = token.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];
            if (!tkparts.empty()) {
                tkparts.forEach(function (val, i, args) {
                    args[i] = val.trim();
                });

                let tkname, tkalign, tkargs;
                tkname = tkparts[0];
                tkargs = tkparts.slice(1, tkparts.length);
                tkalign = "left";
                if ("-" === tkname.charAt(0)) {
                    tkname = tkname.substr(1);
                    if ("-" === tkname.slice(-1)) {
                        tkalign = "center";
                        tkname = tkname.substr(0, tkname.length - 1);
                    }
                    else
                        tkalign = "right";
                }

                let tk = {
                    name: tkname,
                    align: tkalign,
                    args: tkargs
                };

                let local_args = args.slice();
                local_args.unshift(tk);

                let subs = subst_fn.apply(str, local_args);
                if (undefined !== subs &amp;&amp; null !== subs &amp;&amp; subs.toString)
                    return subs.toString();
            }
            return match;
        });
    },


    /**
     * For internal use only, use one of the specialized methods 'alignL', alignR' and
     * 'alignC'.&lt;br> Pads the given string (str) to fit in the given 'width'. Padding is
     * added to the beginning, the end or both depending on the value of the 'alignment'
     * attribute, possible values are: &lt;b>"left"&lt;/b>, &lt;b>"right"&lt;/b> and &lt;b>"center"&lt;/b>.
     * The padding character can be defined through the 'fill_char' argument, if the
     * argument is omitted, an space character (" ") is used. If the given string is
     * longer than the given width, no padding is added and the original string is
     * returned back to the caller.
     * @param {String} str
     * The string (or string serializable object) to be aligned.
     * @param {Number} width
     * The number of characters the resulting string should have.
     * @param {String} [alignment="left"]
     * Indicates whether the string should be aligned to the right, left or center.
     * @param {String} [fill_char]
     * Character to be appended or prepended to the given string.
     * @returns {String}
     * Returns the padded string.
     */
    align: function (str, width, alignment, fill_char) {
        str = _normStr(str, "str_util.align");
        if (!width || isNaN(width) || 0 >= width)
            return str;

        width = Number(width);  // Make sure we are working with a number
        fill_char = _normStr(fill_char, "str_util.align", " ", 1);

        if (!alignment) alignment = "left";
        switch (alignment) {
            case "left":
                if (width &lt;= str.length)
                    return str;

                return str + new Array(width - str.length + 1).join(fill_char);
            case "center":
                // Using space if fill_char is not given or if it is an empty string

                if (width &lt;= str.length)
                    return str;

                let padd = new Array(
                    Math.floor((width - str.length) / 2) + 1).join(fill_char);
                let res = padd + str + padd;

                // Remainder added to the end
                if (res.length &lt; width)
                    res += fill_char;
                return res;
            case "right":
                if (width &lt;= str.length)
                    return str;

                return new Array(width - str.length + 1).join(fill_char) + str;
            default:
                throw new Error("Invalid call to 'str_util.align', the alignment " +
                    "method is not supported.");
        }
    },


    /**
     * Pads the given string (str) to fit in the given 'width'. Padding is added to the
     * beginning and end of the string such that 'str' is centered within the given
     * number of characters. The padding character can be defined through the
     * &lt;b>fill_char&lt;/b> argument, if the argument is omitted, the space character (" ")
     * is used. If the given string is longer than the given width, no padding is added
     * and the original * string is returned back to the caller.
     * @param {String} str
     * The string (or string serializable object) to be aligned.
     * @param {Number} width
     * The number of characters the resulting string should have.
     * @param {String} [fill_char]
     * Character to be appended or prepended to the given string.
     * @returns {String}
     * Returns the padded string.
     */
    alignC: function (str, width, fill_char) {
        return this.align(str, width, "center", fill_char);
    },


    /**
     * Pads the given string (str) to fit in the given 'width'. Padding is added to the
     * end of the string. The padding character can be defined through the
     * &lt;b>fill_char&lt;/b> argument, if the argument is omitted, the space character (" ")
     * is used. If the given string is longer than the given width, no padding is added
     * and the original string is returned back to the caller.
     * @param {String} str
     * The string (or string serializable object) to be aligned.
     * @param {Number} width
     * The number of characters the resulting string should have.
     * @param {String} [fill_char]
     * Character to be appended or prepended to the given string.
     * @returns {String}
     * Returns the padded string.
     */
    alignL: function (str, width, fill_char) {
        return this.align(str, width, "left", fill_char);
    },


    /**
     * Pads the given string (str) to fit in the given 'width'. Padding is added to the
     * beginning of the string. The padding character can be defined through the
     * &lt;b>fill_char&lt;/b> argument, if the argument is omitted, the space character (" ")
     * is used. If the given string is longer than the given width, no padding is added
     * and the original string is returned back to the caller.
     * @param {String} str
     * The string (or string serializable object) to be aligned.
     * @param {Number} width
     * The number of characters the resulting string should have.
     * @param {String} [fill_char]
     * Character to be appended or prepended to the given string.
     * @returns {String}
     * Returns the padded string.
     */
    alignR: function (str, width, fill_char) {
        return this.align(str, width, "right", fill_char);
    },


    /**
     * Creates and object by de-serializing the string. The string must contain a valid
     * JSON document or an error will be thrown by the "eval" function. To use the JSON
     * safe parser, pass a parameter of "null" in "reviver", or  valid reviver function.
     * @param {String} doc
     * JSON document to be parsed and converted to an object.
     * @param {ReviverCallback} reviver
     * Callback function use to customize value conversion when parsing the json document.
     * @returns {Object}
     * Returns an 'Object' that contains all the properties of the JSON document.
     */
    toObject: function (doc, reviver) {
        if (undefined === reviver)
            return eval('(' + doc.toString() + ')');

        return JSON.parse(doc.toString(), reviver);
    },


    /**
     * Generates a CRC32 checksum for the given string.
     * @param {String} str
     * The string (or string serializable object) to use for crc32 checksum generation.
     */
    crc32: function (str) {
        if (!str)
            throw new Error("Invalid call to 'str_util.crc32', the str parameter is " +
                "not optional.");

        if (!str.toString)
            throw new Error("Invalid call to 'str_util.align', the 'str' parameter " +
                "must be a 'String' or support the 'toString' method.");
        str = str.toString();       // Make sure we have a string to work with

        let crc_table = makeCRCTable();
        let crc = 0 ^ (-1);

        for (let i = 0; i &lt; str.length; i++)
            crc = (crc >>> 8) ^ crc_table[(crc ^ str.charCodeAt(i)) &amp; 0xFF];

        return (crc ^ (-1)) >>> 0;

        function makeCRCTable() {
            let c;
            let crc_table = [];
            for (let n = 0; n &lt; 256; n++) {
                c = n;
                for (let k = 0; k &lt; 8; k++)
                    c = ((c &amp; 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));
                crc_table[n] = c;
            }
            return crc_table;
        }
    },


    /**
     * Substitutes date/time tokens with the given date/time with optional formatting,
     * e.g. {{date[, frmStr: String}}.
     * @param {string} str
     * String where token substitution is to be applied.
     * @param {Date} [date]
     * Optional date to be used for substitution, if not provided, the current
     * date/time is used.
     * @param {Number} [width]
     * Width used for alignment
     * @returns {String}
     */
    substDate: function (str, date, width) {
        if (undefined === str)
            throw new Error("Invalid call to 'str_util.subst.date', the 'str' " +
                "argument is not optional.");

        return module.exports.expand(str, function (token, dt) {
            if ("date" === token.name) {
                if (Object.isType(token.args[0], String))
                    return module.exports.align(dt.format(token.args[0]), width,
                        token.align);

                return module.exports.align(dt, width, token.align);
            }
        }, date || new Date());
    },


    /**
     * Substitutes the a token with an object property. Properties of child objects
     * can be specified as tokens using dot notation, e.g. "{{process.path}}".
     * @param {string} str
     * String where token substitution is to be applied.
     * @param {Object} obj
     * Object where properties are to be used for substitution.
     * @param {Number} [width]
     * Width used for alignment
     * @param {FormatterCallback} [cb]
     * @return {String}
     */
    substProp: function (str, obj, width, cb) {
        if (!obj || undefined === obj)
            throw new Error("Invalid call to 'str_util.subst.prop', the 'obj' and " +
                "'obj' arguments are not optional");

        if (Object.isType(width, Function)) {
            cb = width;
            width = undefined;
        }

        return module.exports.expand(str, function (token, obj) {
            let val = getPropValue(obj, token.name.split("."), token.args, cb);
            if (undefined !== val &amp;&amp; null !== val)
                return module.exports.align(val, width, token.align);
        }, obj);

        function getPropValue(obj, props, args, cb) {
            let prop_name = props.shift();
            if (0 === props.length) {
                if (cb) {
                    let val = cb(obj, prop_name);
                    if (undefined !== val &amp;&amp; null !== val)
                        return valueToStr(val, args);
                }
                return valueToStr(obj[prop_name], args);
            }

            if (undefined !== obj[prop_name] &amp;&amp; null !== obj[prop_name])
                if (Object.isType(obj[prop_name], Object))
                    return getPropValue(obj[prop_name], props, args, cb);
        }

        function valueToStr(val, args) {
            if (Object.isPrimitive(val))
                return val.toString();

            if (Object.isType(val, Date)) {
                if (Object.isType(args[0], String))
                    return val.format(args[0]);

                return val.toString();
            }

            if (Object.isType(val, Object)) {
                if (val.toString)
                    return val.toString();
                return val.toJSONEx();
            }

            return null;
        }
    },


    /**
     * Expands environment variables in the given string. substitution tokens are of the form
     * $(ENV_NAME)
     * @param {string} str
     * String to be expanded.
     * @return {string}
     * Expanded string.
     */
    substEnv: function (str) {
        return str.replace(/\$\(([^%]+)\)/g,
            function (_, env_var) {
                return process.env[env_var.trim()];
            }
        );
    },


    /**
     * Creates a table with the given data, specifications and width. The &lt;b>table_data&lt;/b>
     * contains columns specifications through the &lt;b>columns&lt;/b> property, and data through
     * the &lt;b>rows&lt;/b> property and rows of data
     * @param {*} table_data
     * @param {Number} width
     * @returns {string}
     */
    buildTable: function (table_data, width) {
        if (Object.isPrimitive(table_data))
            table_data = {rows: [table_data.toString()]};

        if (Object.isType(table_data, Array)) {
            let res = "";
            table_data.forEach(function (val) {
                res += this.buildTable(val, width) + os.EOL;
            });

            return res;
        }

        if (!Object.isType(table_data.columns, Array))
            if (table_data.columns &amp;&amp; 0 === table_data.columns.length)
                delete table_data.columns;

        if (!table_data.columns)
            table_data.columns = [{width: "auto", align: "left"}];

        if (!table_data.rows || !Object.isType(table_data.columns, Array))
            throw new Error("Invalid call to 'buildTable', the table data is not valid, " +
                "either the 'columns' or 'rows' collection is missing or invalid.");


        // Need to adjust width down since Columnify adds a character between columns.
        let unadj_width = width;
        width -= table_data.columns.length - 1;

        let col_width = calcColumnWidth(table_data.columns, table_data.rows);
        let specs = {};
        specs.showHeaders = false;
        specs.config = [];
        col_width.forEach(function (col) {
            specs.config.push({
                minWidth: col.width,
                maxWidth: col.width
            });
        });

        let tables = [];
        let table = [];
        table_data.rows.forEach(function (row) {
            if (Object.isType(row, String)) {
                if (!table.empty()) {
                    tables.push(table);
                    table = [];
                }
                tables.push(row);
            }
            else
                table.push(row);
        });

        // Add last table table if it was not empty
        if (!table.empty())
            tables.push(table);

        let res = "";
        let config = buildConfig(col_width);
        tables.forEach(function (t) {
            if (Object.isType(t, String)) {
                if ("=" === t)
                    res += module.exports.fill(unadj_width, "=") + os.EOL;
                else {
                    let align = "left";
                    if ("-" === t.charAt(0)) {
                        t = t.substr(1);
                        if ("-" === t.slice(-1)) {
                            align = "center";
                            t = t.substr(0, t.length - 1);
                        }
                        else
                            align = "right";
                    }

                    res += columnify([[t.toString()]], {
                            showHeaders: false,
                            config: [{
                                minWidth: unadj_width,
                                maxWidth: unadj_width,
                                align: align
                            }]
                        }) + os.EOL;
                }
            }
            else
                res += columnify(t, config) + os.EOL;
        });
        return res;

        function buildConfig(columns) {
            let res = {
                showHeaders: false,
                config: []
            };

            columns.forEach(function (col) {
                res.config.push({
                    minWidth: col.width,
                    maxWidth: col.width,
                    align: col.align
                });
            });
            return res;
        }

        function calcColumnWidth(columns, rows) {
            if (!columns) {
                columns = [{width: "auto"}];
            }

            let res = [];
            columns.forEach(function (col, i) {
                res[i] = {};
                res[i].maxWidth = 0;
            });

            rows.forEach(function (row) {
                if (Object.isType(row, Array)) {
                    row.forEach(function (cell, i) {
                        if (i &lt; res.length) {
                            res[i].maxWidth =
                                Math.max(res[i].maxWidth, cell.toString().length);
                            if (Object.isType(columns[i].maxWidth, Number))
                                res[i].maxWidth =
                                    Math.min(res[i].maxWidth, columns[i].maxWidth);
                        }
                    });
                }
            });

            let fit_col = -1;
            let non_fit_width = 0;
            let fixed_width = 0;
            let auto_width_count = 0;
            columns.forEach(function (col, i) {
                if ("fit" === col.width &amp;&amp; -1 === fit_col)
                    fit_col = i;
                else {
                    if (!isNaN(col.width)) {
                        res[i].width = Number(col.width);
                        fixed_width += res[i].width;
                    }
                    else {
                        res[i].width = res[i].maxWidth;
                        auto_width_count++;
                    }
                    non_fit_width += res[i].width;
                }
                res[i].align = col.align;
            });

            if (0 &lt;= fit_col) {
                let fit_width = res[fit_col].maxWidth;

                if ((non_fit_width + fit_width / 2) &lt;= width)
                    res[fit_col].width = width - non_fit_width;
                else {
                    non_fit_width += res[fit_col].maxWidth;
                    res[fit_col].width = res[fit_col].maxWidth;
                }
            }

            if (non_fit_width > width) {
                let ratio = width / non_fit_width + fit_width;
                res.forEach(function (r) {
                    r.width = Math.trunc(r.width * ratio);
                });
            }
            else if (0 > fit_col &amp;&amp; 0 &lt; auto_width_count) {
                let auto_width = Math.trunc((width - fixed_width) / auto_width_count);
                let rem = width - fixed_width - (auto_width * auto_width_count);
                let last;
                if (0 &lt; auto_width) {
                    res.forEach(function (val, i, arr) {
                        if ("auto" === columns[i].width) {
                            arr[i].width = auto_width;
                            last = arr[i];
                        }
                    });
                    if (last &amp;&amp; rem)
                        last.width += rem;
                }
            }


            return res;
        }
    }
};
//


/**
 * For internal use only. This method normalizes the given 'str'. If necessary the string
 * is truncated to 'len' number of characters. 'def_value' is returned if 'str' is empty
 * or null. The method throws if 'str' can't be converted to a string or if it is shorter
 * than the required number of characters 'len'.
 * @private
 * @param {String} str The string to be processed
 * @param {String} caller Name of the function that called '_normStr'. Used in
 * exception messages.
 * @param {String} [def_value] The value to be used if 'str' is empty, null or not
 * defined.
 * @param {Number} [len] If provided, '_normStr' truncates the resulting string to
 * 'len' number of
 * @returns {String} Returns the processed string.
 */
function _normStr(str, caller, def_value, len) {
    if (str &amp;&amp; !str.toString)
        throw new Error("Invalid call to '" + caller + "', the 'str' argument must be " +
            "a string or support the 'toString' method.");

    if (!str) {
        if (!def_value)
            throw new Error("Invalid call to '" + caller + "', the 'str' argument is " +
                "not optional.");
        return def_value;
    }

    str = str.toString();   // Make sure we are working with a string
    if (0 == str.length) {
        if (!len)
            return str;

        if (def_value)
            return def_value;
    }

    if (len) {
        if (len > str.length)
            throw new Error("Invalid call to '" + caller + "', the 'str' parameter " +
                "does not meet the length requirement.");

        return str.substring(0, len);
    }

    return str;
}

</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="width: 0px; height: 0px">
    <div class="footer-text"><b>Crabel Core Library for JavaScript</b></div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
